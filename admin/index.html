<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Blog Admin Login">
    <meta name="robots" content="noindex, nofollow">
    <title>Blog Admin - Login</title>

    <!-- Stylesheets -->
    <link rel="stylesheet" href="../css/variables.css">
    <link rel="stylesheet" href="../css/main.css">
    <link rel="stylesheet" href="../css/components.css">

    <!-- Favicon -->
    <link rel="icon" type="image/png" href="../assets/icons/favicon.png">

    <style>
        body {
            margin: 0;
            padding: 0;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--color-bg-primary);
        }

        .login-container {
            width: 100%;
            max-width: 420px;
            padding: var(--space-md);
        }

        .login-card {
            background: var(--color-bg-secondary);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-xl);
            padding: var(--space-2xl);
            box-shadow: var(--shadow-xl);
        }

        .login-header {
            text-align: center;
            margin-bottom: var(--space-2xl);
        }

        .login-title {
            font-size: var(--font-size-2xl);
            font-weight: var(--font-weight-bold);
            color: var(--color-text-primary);
            margin: 0 0 var(--space-sm) 0;
        }

        .login-subtitle {
            font-size: var(--font-size-base);
            color: var(--color-text-secondary);
            margin: 0;
        }

        .form-group {
            margin-bottom: var(--space-lg);
        }

        .form-label {
            display: block;
            font-size: var(--font-size-sm);
            font-weight: var(--font-weight-medium);
            color: var(--color-text-secondary);
            margin-bottom: var(--space-xs);
        }

        .form-input {
            width: 100%;
            padding: var(--space-sm) var(--space-md);
            font-size: var(--font-size-base);
            font-family: var(--font-family-primary);
            color: var(--color-text-primary);
            background: var(--color-bg-primary);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-md);
            transition: var(--transition-base);
            box-sizing: border-box;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--color-primary);
            box-shadow: 0 0 0 3px rgba(96, 165, 250, 0.1);
        }

        .form-checkbox-group {
            display: flex;
            align-items: center;
            gap: var(--space-xs);
            margin-bottom: var(--space-lg);
        }

        .form-checkbox {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        .form-checkbox-label {
            font-size: var(--font-size-sm);
            color: var(--color-text-secondary);
            cursor: pointer;
            user-select: none;
        }

        .login-button {
            width: 100%;
            padding: var(--space-sm) var(--space-lg);
            font-size: var(--font-size-base);
            font-weight: var(--font-weight-semibold);
            color: white;
            background: var(--color-primary);
            border: none;
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: var(--transition-base);
        }

        .login-button:hover {
            background: var(--color-primary-dark);
            transform: translateY(-1px);
            box-shadow: var(--shadow-md);
        }

        .login-button:active {
            transform: translateY(0);
        }

        .login-button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .form-message {
            margin-top: var(--space-md);
            padding: var(--space-sm) var(--space-md);
            border-radius: var(--radius-md);
            font-size: var(--font-size-sm);
            text-align: center;
        }

        .form-message.success {
            background: rgba(16, 185, 129, 0.1);
            color: var(--color-success);
            border: 1px solid var(--color-success);
        }

        .form-message.error {
            background: rgba(239, 68, 68, 0.1);
            color: var(--color-error);
            border: 1px solid var(--color-error);
        }

        .form-message.info {
            background: rgba(59, 130, 246, 0.1);
            color: var(--color-info);
            border: 1px solid var(--color-info);
        }

        .back-link {
            display: block;
            text-align: center;
            margin-top: var(--space-lg);
            font-size: var(--font-size-sm);
            color: var(--color-text-tertiary);
            text-decoration: none;
            transition: var(--transition-base);
        }

        .back-link:hover {
            color: var(--color-primary);
        }

        .password-requirements {
            font-size: var(--font-size-xs);
            color: var(--color-text-tertiary);
            margin-top: var(--space-xs);
        }
    </style>
</head>
<body>
    <div class="login-container">
        <div class="login-card">
            <div class="login-header">
                <h1 class="login-title">Blog Admin</h1>
                <p class="login-subtitle" id="subtitle">Enter your password to continue</p>
            </div>

            <form id="login-form">
                <div class="form-group">
                    <label for="password" class="form-label">Password</label>
                    <input
                        type="password"
                        id="password"
                        name="password"
                        class="form-input"
                        placeholder="Enter your password"
                        required
                        autocomplete="current-password"
                    >
                    <p class="password-requirements" id="requirements" style="display: none;">
                        Password must be at least 6 characters long
                    </p>
                </div>

                <div class="form-checkbox-group">
                    <input
                        type="checkbox"
                        id="remember"
                        name="remember"
                        class="form-checkbox"
                    >
                    <label for="remember" class="form-checkbox-label">
                        Remember me for 30 days
                    </label>
                </div>

                <button type="submit" class="login-button" id="submit-btn">
                    Login
                </button>

                <div id="message" class="form-message" style="display: none;"></div>
            </form>

            <a href="../index.html" class="back-link">‚Üê Back to website</a>
        </div>
    </div>

    <!-- Scripts -->
    <script src="../js/blog-auth.js"></script>
    <script>
        // Login form handling
        const loginForm = document.getElementById('login-form');
        const passwordInput = document.getElementById('password');
        const rememberCheckbox = document.getElementById('remember');
        const submitButton = document.getElementById('submit-btn');
        const messageDiv = document.getElementById('message');
        const subtitle = document.getElementById('subtitle');
        const requirements = document.getElementById('requirements');

        // Check if this is first-time setup
        const isFirstTime = !window.BlogAuth.isPasswordSet();

        if (isFirstTime) {
            subtitle.textContent = 'Set up your admin password';
            submitButton.textContent = 'Create Password';
            requirements.style.display = 'block';
        }

        // Check if already authenticated
        if (window.BlogAuth.isAuthenticated()) {
            // Get redirect URL or default to editor
            const redirectUrl = window.BlogAuth.getRedirectUrl() || 'editor.html';
            window.location.href = redirectUrl;
        }

        // Handle form submission
        loginForm.addEventListener('submit', async (e) => {
            e.preventDefault();

            const password = passwordInput.value;
            const rememberMe = rememberCheckbox.checked;

            // Disable form during submission
            submitButton.disabled = true;
            submitButton.textContent = isFirstTime ? 'Creating...' : 'Logging in...';

            // Attempt login
            const result = await window.BlogAuth.login(password, rememberMe);

            if (result.success) {
                showMessage(result.message, 'success');

                // Redirect after short delay
                setTimeout(() => {
                    const redirectUrl = window.BlogAuth.getRedirectUrl() || 'editor.html';
                    window.location.href = redirectUrl;
                }, 1000);
            } else {
                showMessage(result.message, 'error');
                submitButton.disabled = false;
                submitButton.textContent = isFirstTime ? 'Create Password' : 'Login';
                passwordInput.value = '';
                passwordInput.focus();
            }
        });

        // Show message helper
        function showMessage(text, type = 'info') {
            messageDiv.textContent = text;
            messageDiv.className = `form-message ${type}`;
            messageDiv.style.display = 'block';
        }

        // Focus password input on load
        passwordInput.focus();
    </script>
</body>
</html>
